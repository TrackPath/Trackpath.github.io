
<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>TrackPath</title>
    <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
        
        #map {}
        /* Optional: Makes the sample page fill the window. */
        
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: "Helvetica Neue";
        }
        
        .wrap1 {
            width: 40%;
            position: absolute;
            top: 5%;
            right: 1%;
            transform: translate(-40%, -50%);
        }
        
        .checklist {
            width: 30%;
            position: absolute;
            top: 20%;
            left: 73%;
            margin: 10px 10px 10px 10px;
        }
        
        .goButton {
            position: absolute;
            left: 10%;
            top: 120%;
            width: 90px;
            height: 36px;
            border: 1px solid #00B4CC;
            background: #00B4CC;
            text-align: center;
            color: #fff;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }


        .removeButton {
            position: absolute;
            left: 80%;
            top: 120%;
            width: 90px;
            height: 36px;
            border: 1px solid #00B4CC;
            background: #00B4CC;
            text-align: center;
            color: #fff;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
    </style>
</head>

<body>

    <script>
        var map, infoWindow, markers;


        var icons = new Array();

        function getMarkerImage(iconColor) {
            if ((typeof(iconColor) == "undefined") || (iconColor == null)) {
                iconColor = "red";
            }
            if (!icons[iconColor]) {
                icons[iconColor] = new google.maps.MarkerImage("http://www.geocodezip.com/mapIcons/marker_" + iconColor + ".png",
                    // This marker is 20 pixels wide by 34 pixels tall.
                    new google.maps.Size(20, 34),
                    // The origin for this image is 0,0.
                    new google.maps.Point(0, 0),
                    // The anchor for this image is at 6,20.
                    new google.maps.Point(9, 34));
            }
            return icons[iconColor];

        }



        var iconImage, iconShadow, iconShape

        function createMarker(latlng, label, html, color) {
            console.log("createMarker");

            var contentString = '<b>' + label + '</b><br>' + html;
            var marker = new google.maps.Marker({
                position: latlng,
                draggable: true,
                map: map,
                shadow: iconShadow,
                icon: getMarkerImage(color),
                shape: iconShape,
                title: label,
                zIndex: Math.round(latlng.lat() * -100000) << 5
            });
            marker.myname = label;

            google.maps.event.addListener(marker, 'click', function() {
                console.log(contentString)
                infoWindow.setContent(contentString);
                infoWindow.open(map, marker);
            });
            markers.push(marker);
            return marker;
        }

        // Marker sizes are expressed as a Size of X,Y
        // where the origin of the image (0,0) is located
        // in the top left of the image.

        // Origins, anchor positions and coordinates of the marker
        // increase in the X direction to the right and in
        // the Y direction down.


        

        function initMap() {

             markers = [];


            icons["red"] = new google.maps.MarkerImage("http://www.geocodezip.com/mapIcons/marker_red.png",
                // This marker is 20 pixels wide by 34 pixels tall.
                new google.maps.Size(20, 34),
                // The origin for this image is 0,0.
                new google.maps.Point(0, 0),
                // The anchor for this image is at 9,34.
                new google.maps.Point(9, 34));




            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 7,
                center: {
                    lat: 37.4,
                    lng: -122.1
                },
                gestureHandling: 'greedy'
            });
            
            infoWindow = new google.maps.InfoWindow({
                size: new google.maps.Size(150, 50)
            });


            iconImage = new google.maps.MarkerImage('http://www.geocodezip.com/mapIcons/marker_red.png',
                // This marker is 20 pixels wide by 34 pixels tall.
                new google.maps.Size(20, 34),
                // The origin for this image is 0,0.
                new google.maps.Point(0, 0),
                // The anchor for this image is at 9,34.
                new google.maps.Point(9, 34));
            iconShadow = new google.maps.MarkerImage('http://www.google.com/mapfiles/shadow50.png',
                // The shadow image is larger in the horizontal dimension
                // while the position and offset are the same as for the main image.
                new google.maps.Size(37, 34),
                new google.maps.Point(0, 0),
                new google.maps.Point(9, 34));
            // Shapes define the clickable region of the icon.
            // The type defines an HTML &lt;area&gt; element 'poly' which
            // traces out a polygon as a series of X,Y points. The final
            // coordinate closes the poly by connecting to the first
            // coordinate.
            iconShape = {
                coord: [9, 0, 6, 1, 4, 2, 2, 4, 0, 8, 0, 12, 1, 14, 2, 16, 5, 19, 7, 23, 8, 26, 9, 30, 9, 34, 11, 34, 11, 30, 12, 26, 13, 24, 14, 21, 16, 18, 18, 16, 20, 12, 20, 8, 18, 4, 16, 2, 15, 1, 13, 0],
                type: 'poly'
            };
             document.getElementById('go').addEventListener('click', onClickHandlerGo);
             document.getElementById('remove').addEventListener('click', onClickHandlerRemove);
}


        var onClickHandlerGo = function() {

            initMap();
            var id = navigator.geolocation.getCurrentPosition(success);

            



        }

        var onClickHandlerRemove = function() {




            hideMarkers();
            initMap();
    



        }

    
        //get point at distance along a polyline:


    function hideMarkers() {
    for (var i = 0; i < markers.length; i++) {
        markers[i].setMap(null); //Remove the marker from the map
    }
    
}






        function showMarkersWithinDistance(latlngcenter, dist, placetype) {
            console.log("e");
            map.setZoom(12);

            latlngsarr = [];

            var request = {
                location: latlngcenter,
                radius: dist,
                rankby: 'distance',
                type: [placetype]
            };

            function callback(results, status) {
                if (status == google.maps.places.PlacesServiceStatus.OK) {
                    for (var i = 0; i < results.length; i++) {
                        var place = results[i];
                        createMarker(place.geometry.location, "", "");
                    }
                }
            }


            var service = new google.maps.places.PlacesService(map);
            service.nearbySearch(request, callback);



            for (var i = 0; i < latlngsarr.length; i++) {
                if (google.maps.geometry.spherical.computeDistanceBetween(latlngcenter, latlngsarr[i]) < dist) {

                    createMarker(latlngsarr[i], "", "");
                }

            }
            map.panTo(LatLng)
        }



        function success(pos) {
            console.log("success");

            markers = [];
            if (document.getElementById("isAttractions").checked == true){
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'museum');
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'amusement_park');
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'aquarium');
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'park');
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'art_gallery');
            }
            if (document.getElementById("isDining").checked == true) {
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'restaurant');
            }
            if (document.getElementById("isHotels").checked == true) {
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'lodging');
            }
            if (document.getElementById("isGas").checked == true) {
              showMarkersWithinDistance(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude), 3218.69, 'gas_station');
            }



        }
        


        function handleLocationError(browserHasGeolocation, infoWindow, pos) {
            infoWindow.setPosition(pos);
            infoWindow.setContent(browserHasGeolocation ?
                'Error: The Geolocation service failed.' :
                'Error: Your browser doesn\'t support geolocation.');
            infoWindow.open(map);
        }
    </script>

    <div id="map" style="float:left;width:70%; height:100%"></div>
    <div class="wrap1">
        <div class="checklist">
            <h4>Include:</h4>
            <form>
                <input type="checkbox" id="isAttractions" value="attractions"> Attractions <br>
                <input type="checkbox" id="isDining" value="dining"> Dining <br>
                <input type="checkbox" id="isHotels" value="hotels"> Hotels <br>
                <input type="checkbox" id="isGas" value="gas"> Gas Stations <br>
                <button id="go" type="button" class="goButton">Go!</button>
                <button id="remove" type="button" class="removeButton">Remove Markers</button>
            </form>
        </div>
    </div>
    <br>


    
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwkySP3nSq82zce2Ie-fVPWpRZU1huUQs&amp;libraries=places,geometry&amp;callback=initMap"></script>




</body>

</html>